generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Настройки директоров для уведомлений
model Director {
  id            Int           @id @default(autoincrement())
  cities        String[]
  name          String
  login         String        @unique
  password      String
  contractDoc   String?       @map("contract_doc")
  passportDoc   String?       @map("passport_doc")
  dateCreate    DateTime      @default(now()) @map("date_create")
  note          String?
  tgId          String?       @map("tg_id")
  createdAt     DateTime      @default(now()) @map("created_at")
  updatedAt     DateTime      @updatedAt @map("updated_at")
  
  @@map("director")
}

// Настройки мастеров для уведомлений
model Master {
  id            Int           @id @default(autoincrement())
  cities        String[]
  name          String
  login         String?       @unique
  password      String?
  passportDoc   String?       @map("passport_doc")
  contractDoc   String?       @map("contract_doc")
  statusWork    String        @map("status_work")
  dateCreate    DateTime      @default(now()) @map("date_create")
  note          String?
  tgId          String?       @map("tg_id")
  chatId        String?       @map("chat_id")
  createdAt     DateTime      @default(now()) @map("created_at")
  updatedAt     DateTime      @updatedAt @map("updated_at")
  
  orders        Order[]
  
  @@map("master")
}

// Для связи с заказами (read-only)
model Order {
  id                    Int       @id @default(autoincrement())
  rk                    String
  city                  String
  avitoName             String?   @map("avito_name")
  phone                 String
  typeOrder             String    @map("type_order")
  clientName            String    @map("client_name")
  address               String
  dateMeeting           DateTime  @map("date_meeting")
  typeEquipment         String    @map("type_equipment")
  problem               String
  callRecord            String?   @map("call_record")
  statusOrder           String    @map("status_order")
  masterId              Int?      @map("master_id")
  result                Decimal?  @db.Decimal(10, 2)
  expenditure           Decimal?  @db.Decimal(10, 2)
  operatorNameId        Int       @map("operator_name_id")
  createDate            DateTime  @map("create_date")
  closingData           DateTime? @map("closing_data")
  dateClosmod           DateTime? @map("date_closmod")
  createdAt             DateTime  @default(now()) @map("created_at")
  updatedAt             DateTime  @updatedAt @map("updated_at")
  
  master                Master?   @relation(fields: [masterId], references: [id])
  
  @@map("orders")
}

