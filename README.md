# Notifications Service

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ Telegram –∏ –¥—Ä—É–≥–∏–µ –∫–∞–Ω–∞–ª—ã.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### Telegram Notifications
- üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞–º –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
- üìÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–µ—Ä–µ–Ω–æ—Å–µ –¥–∞—Ç –≤—Å—Ç—Ä–µ—á–∏
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—Ç–∫–∞–∑–∞—Ö
- üéØ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ—Ä–æ–¥–∞–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤
- üìù –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π

### –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°—Ç–∞—Ç—É—Å—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ (pending, sent, failed)
- –ü–æ–≤—Ç–æ—Ä –Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫

## API Endpoints

### Notifications
- `POST /api/v1/notifications/send` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- `POST /api/v1/notifications/new-order` - –ù–æ–≤—ã–π –∑–∞–∫–∞–∑
- `POST /api/v1/notifications/date-change` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞—Ç—ã
- `POST /api/v1/notifications/order-rejection` - –û—Ç–∫–∞–∑ –æ—Ç –∑–∞–∫–∞–∑–∞
- `GET /api/v1/notifications/history` - –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### Directors
- `GET /api/v1/directors` - –°–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤
- `PUT /api/v1/directors/:id/telegram` - –û–±–Ω–æ–≤–∏—Ç—å Telegram –¥–∞–Ω–Ω—ã–µ

### Templates
- `GET /api/v1/templates` - –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π
- `PUT /api/v1/templates/:type` - –û–±–Ω–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω

## Environment Variables

```env
DATABASE_URL=postgresql://user:pass@host:port/db
JWT_SECRET=your-secret
PORT=5008
TELEGRAM_BOT_TOKEN=your-bot-token
TELEGRAM_API_URL=https://api.telegram.org
WEBHOOK_TOKEN=your-webhook-secret
```

## –§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```json
{
  "type": "new_order",
  "orderId": 123,
  "city": "–°–∞—Ä–∞—Ç–æ–≤",
  "data": {
    "clientName": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
    "phone": "+79001234567",
    "address": "—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10",
    "dateMeeting": "2025-01-15T10:00:00Z",
    "problem": "–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫"
  }
}
```

## –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π

### new_order
```
üÜï –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ #{orderId}

üë§ –ö–ª–∏–µ–Ω—Ç: {clientName}
üìû –¢–µ–ª–µ—Ñ–æ–Ω: {phone}
üìç –ê–¥—Ä–µ—Å: {address}
üóì –î–∞—Ç–∞ –≤—Å—Ç—Ä–µ—á–∏: {dateMeeting}
üîß –ü—Ä–æ–±–ª–µ–º–∞: {problem}
üèô –ì–æ—Ä–æ–¥: {city}
```

### date_change
```
üìÖ –ü–µ—Ä–µ–Ω–æ—Å –¥–∞—Ç—ã –≤—Å—Ç—Ä–µ—á–∏

üìã –ó–∞—è–≤–∫–∞ #{orderId}
üë§ –ö–ª–∏–µ–Ω—Ç: {clientName}
üóì –ù–æ–≤–∞—è –¥–∞—Ç–∞: {newDate}
üèô –ì–æ—Ä–æ–¥: {city}
```

### order_rejection
```
‚ùå –û—Ç–∫–∞–∑ –æ—Ç –∑–∞—è–≤–∫–∏

üìã –ó–∞—è–≤–∫–∞ #{orderId}
üë§ –ö–ª–∏–µ–Ω—Ç: {clientName}
üìû –¢–µ–ª–µ—Ñ–æ–Ω: {phone}
üí¨ –ü—Ä–∏—á–∏–Ω–∞: {reason}
üèô –ì–æ—Ä–æ–¥: {city}
```

## Docker

```bash
docker build -t notifications-service .
docker run -p 5008:5008 notifications-service
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Bot

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env` –∫–∞–∫ `TELEGRAM_BOT_TOKEN`
4. –ö–∞–∂–¥—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ –ø–æ–ª—É—á–∏—Ç—å chat_id
5. –û–±–Ω–æ–≤–∏—Ç–µ chat_id –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ API

